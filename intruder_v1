`timescale 1ns / 1ps

module intruder_alert_controller (
    input wire clk,
    input wire reset,
    input wire motion_detected,      
    input wire tick_1hz,             
    input wire tick_blink,           
    output reg buzzer_on,
    output reg [3:0] security_leds   
);

    reg [1:0] alarm_timer;
    reg alarm_active;


    always @(posedge clk or posedge reset) begin
        if (reset) begin
            buzzer_on <= 0;
            security_leds <= 4'b0000;
            alarm_active <= 0;
            alarm_timer <= 0;
        end else begin
            
            if (motion_detected && !alarm_active) begin
                alarm_active <= 1;
                alarm_timer <= 2;
                end
            if (alarm_active) begin
                buzzer_on <= 1;
                if (tick_blink) 
                    security_leds <= ~security_leds; 
                if (tick_1hz) begin
                    if (alarm_timer > 0)
                        alarm_timer <= alarm_timer - 1;
                    else begin
                        alarm_active <= 0;
                        buzzer_on <= 0;
                        security_leds <= 4'b0000;
                    end
                end
            end else begin
                buzzer_on <= 0;
                security_leds <= 4'b0000;
            end
        end
    end
endmodule 